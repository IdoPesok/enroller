// bump
generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextSearch", "fullTextIndex"]
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model Courses {
  Code                   String                   @id @db.VarChar(10)
  Prefix                 String                   @db.VarChar(6)
  Number                 Int
  MinUnits               Int
  MaxUnits               Int
  Name                   String                   @db.VarChar(128)
  Description            String?                  @db.Text
  Prereqs                Json?
  Sections               Sections[]
  GraduationRequirements GraduationRequirements[]

  @@fulltext([Code, Name, Description], map: "SearchIndex")
  @@fulltext([Code, Name], map: "ShortSearchIndex")
}

model Enrolled {
  User      String @id @db.VarChar(35)
  SectionId Int
}

model Sections {
  Course           String             @db.VarChar(10)
  Start            DateTime           @db.Time(0)
  End              DateTime           @db.Time(0)
  Sunday           Boolean?           @db.Bit(1)
  Monday           Boolean?           @db.Bit(1)
  Tuesday          Boolean?           @db.Bit(1)
  Wednesday        Boolean?           @db.Bit(1)
  Thursday         Boolean?           @db.Bit(1)
  Friday           Boolean?           @db.Bit(1)
  Saturday         Boolean?           @db.Bit(1)
  Capacity         Int?
  WaitlistCapacity Int?
  Professor        String             @db.VarChar(255)
  Room             String?            @db.VarChar(10)
  Format           Sections_Format?
  Modality         Sections_Modality?
  Courses          Courses            @relation(fields: [Course], references: [Code])

  @@id([Course, Start, Professor])
  @@index([Course], map: "Course")
}

model Flowcharts {
  FlowchartId            String                   @id @db.VarChar(255)
  CatalogYear            String                   @db.VarChar(10)
  MajorId                String                   @db.VarChar(24)
  ConcentrationId        String                   @db.VarChar(24)
  Catalog                Catalogs                 @relation(fields: [CatalogYear], references: [CatalogYear])
  Major                  Majors                   @relation(fields: [MajorId], references: [Id])
  Concentration          Concentrations           @relation(fields: [ConcentrationId, MajorId], references: [Id, MajorId])
  GraduationRequirements GraduationRequirements[]

  @@index([CatalogYear])
  @@index([MajorId])
  @@index([ConcentrationId, MajorId])
}

model Catalogs {
  CatalogYear String       @id @db.VarChar(10)
  Flowcharts  Flowcharts[]
}

model Concentrations {
  Id         String       @db.VarChar(10)
  Name       String?      @db.VarChar(255)
  MajorId    String       @db.VarChar(255)
  Major      Majors       @relation(fields: [MajorId], references: [Id])
  Flowcharts Flowcharts[]

  @@id([Id, MajorId])
  @@index([MajorId])
}

model GraduationRequirements {
  FlowchartId String     @db.VarChar(255)
  Code        String     @db.VarChar(10)
  Flowchart   Flowcharts @relation(fields: [FlowchartId], references: [FlowchartId])
  Course      Courses    @relation(fields: [Code], references: [Code])

  @@id([FlowchartId, Code])
  @@index([FlowchartId])
  @@index([Code])
}

model Majors {
  Id             String           @id @db.VarChar(24)
  Name           String           @db.VarChar(255)
  Flowcharts     Flowcharts[]
  Concentrations Concentrations[]
}

enum Sections_Format {
  Lecture
  Seminar
  Lab
}

enum Sections_Modality {
  Online
  InPerson
  TBD
}
